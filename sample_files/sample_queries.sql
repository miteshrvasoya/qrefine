WITH results AS( SELECT * FROM fintech_engineers.orders o LEFT JOIN fintech_engineers.ledger l ON l.owner_entity_id = o.chemist_id LEFT JOIN fintech_engineers.ledger_details ltd ON ltd.ledger_id = l.id WHERE o.id IN (1, 2, 3, 4, 5) GROUP BY o.id, l.owner_entity_id, transaction_table_id ) SELECT order_id, total, credit_entry_amount, chemist_id, transaction_table_id FROM results;